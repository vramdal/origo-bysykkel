(this["webpackJsonporigo-bysykkel"]=this["webpackJsonporigo-bysykkel"]||[]).push([[0],{16:function(t,e,a){t.exports=a(30)},21:function(t,e,a){},28:function(t,e,a){},30:function(t,e,a){"use strict";a.r(e);var n,r=a(0),c=a.n(r),o=a(7),i=a.n(o),s=(a(21),a(5)),l=(a(28),a(3)),u=a.n(l),d=a(1),I=a(2);!function(t){t.INITIALIZING="INITIALIZING",t.SUCCESS="SUCCESS",t.FAILURE="FAILURE"}(n||(n={}));var f,E,T,O=a(6),S=a.n(O),m=a(11),N=function(){var t=Object(m.a)(S.a.mark((function t(e){return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise((function(t,a){setTimeout((function(){return fetch(e,{headers:new Headers({"Client-Identifier":"vidarramdal-origo-oppgave"})}).then((function(e){return t(e)})).catch((function(t){return a(t)}))}),1e3)})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),b=function(){var t=Object(m.a)(S.a.mark((function t(e){return S.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",N(e).then((function(t){return t.json()})));case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}();function p(t,e){var a=t.data.nb.feeds.find((function(t){return t.name===e}));if(!a)throw new Error("Har ikke URL til feed: "+e);return a.url}var A="AUTODISCOVERY_COMPLETE",v={urls:{stationInfo:void 0,stationStatus:void 0},lastUpdated:(f={},Object(I.a)(f,A,-1),Object(I.a)(f,"STATION_INFORMATION_FETCHED",-1),Object(I.a)(f,"STATION_STATUS_FETCHED",-1),f),ttl:(E={},Object(I.a)(E,A,1/0),Object(I.a)(E,"STATION_INFORMATION_FETCHED",60),Object(I.a)(E,"STATION_STATUS_FETCHED",20),E),fetchStates:(T={},Object(I.a)(T,A,n.INITIALIZING),Object(I.a)(T,"STATION_INFORMATION_FETCHED",n.INITIALIZING),Object(I.a)(T,"STATION_STATUS_FETCHED",n.INITIALIZING),T),fetchState:n.INITIALIZING,stationInfo:void 0,stationStatus:void 0};var _=function t(e){return function(a,n){var r="STATION_INFORMATION_FETCHED"===e?"stationInfo":"stationStatus",c=n().urls[r];return c?b(c).then((function(t){a({type:e,payload:t})})).catch((function(t){console.error("Error fetching ".concat(r," from ").concat(c),t),a({type:"FETCH_FAILED",actionName:e})})).finally((function(){var r=n().ttl[e];r<1/0&&setTimeout((function(){a(t(e))}),1e3*r)})):a({type:"NO_OP"})}},h=function(t){return c.a.createElement("div",{role:"table",className:u()(t.className)},t.children)},j=function(t){return c.a.createElement("div",{role:"cell",className:t.className},t.children)},F=function(t){return c.a.createElement("div",{className:u()("row",t.className),role:"row"},t.children)},y=function(t){return c.a.createElement("div",{className:t.className,role:"rowgroup"},t.children)},C=function(t){return c.a.createElement("div",{className:u()(t.className),role:"columnheader"},t.children)},U=function(t){var e,a,r;switch(t.fetchState){case n.INITIALIZING:e="loading-indicator",a="Vent litt, laster data ...";break;case n.FAILURE:e="failure-indicator",a="Beklager, det oppsto en feil",r="alert";break;default:e="success-indicator"}var o=u()("state-indicator",e);return c.a.createElement("div",{"data-testid":e,className:o,role:r},a)},L=function(t){var e=t.station;return c.a.createElement(F,null,c.a.createElement(j,null,e.stationName),c.a.createElement(j,{className:u()({disabled:!e.isReturning,exhausted:0===e.numLocks})},e.numLocks),c.a.createElement(j,{className:u()({disabled:!e.isRenting,exhausted:0===e.numBikes})},e.numBikes))},k=Object(s.b)((function(t){var e;return{fetchState:t.fetchState,stations:null===(e=t.stationInfo)||void 0===e?void 0:e.map((function(e){var a,n=null===(a=t.stationStatus)||void 0===a?void 0:a.find((function(t){return t.station_id===e.station_id}));return{stationId:e.station_id,stationName:e.name,isRenting:1===(null===n||void 0===n?void 0:n.is_renting)||!1,isReturning:1===(null===n||void 0===n?void 0:n.is_returning)||!1,numBikes:null===n||void 0===n?void 0:n.num_bikes_available,numLocks:null===n||void 0===n?void 0:n.num_docks_available}}))}}))((function(t){var e,a=Object(s.c)();return Object(r.useEffect)((function(){a((function(t){return b("https://gbfs.urbansharing.com/oslobysykkel.no/gbfs.json").then((function(e){t({type:A,payload:e}),t(_("STATION_INFORMATION_FETCHED")),t(_("STATION_STATUS_FETCHED"))})).catch((function(e){console.error("Error doing autodiscovery",e),t({type:"FETCH_FAILED",actionName:A})}))}))}),[a]),c.a.createElement(c.a.Fragment,null,c.a.createElement(U,{fetchState:t.fetchState}),c.a.createElement(h,{className:u()("station-table",{disabled:t.fetchState===n.FAILURE})},c.a.createElement(F,{className:"station-table__header"},c.a.createElement(C,null,"Stasjon"),c.a.createElement(C,null,"Antall l\xe5ser"),c.a.createElement(C,null,"Antall sykler")),c.a.createElement(y,{className:"station-table__body"},null===(e=t.stations)||void 0===e?void 0:e.map((function(t){return c.a.createElement(L,{key:t.stationId,station:t})})))))})),R=a(14),g=a(4),D=a(15),H=[R.a],w=Object(g.createStore)((function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,e=arguments.length>1?arguments[1]:void 0;if("FETCH_FAILED"===e.type){var a=Object(d.a)(Object(d.a)({},t.fetchStates),{},Object(I.a)({},e.actionName,n.FAILURE));return Object(d.a)(Object(d.a)({},t),{},{fetchState:n.FAILURE,fetchStates:a})}if(!e.payload||t.lastUpdated[e.type]>=e.payload.last_updated)return t;var r=Object(d.a)(Object(d.a)({},t.lastUpdated),{},Object(I.a)({},e.type,e.payload.last_updated)),c=Object(d.a)(Object(d.a)({},t.ttl),{},Object(I.a)({},e.type,e.payload.ttl)),o=Object(d.a)(Object(d.a)({},t.fetchStates),{},Object(I.a)({},e.type,n.SUCCESS)),i=o.STATION_STATUS_FETCHED===n.SUCCESS&&o.STATION_INFORMATION_FETCHED===n.SUCCESS&&o[A]===n.SUCCESS&&n.SUCCESS||(o.STATION_STATUS_FETCHED===n.FAILURE||o.STATION_INFORMATION_FETCHED===n.FAILURE||o[A]===n.FAILURE)&&n.FAILURE||n.INITIALIZING,s=Object(d.a)(Object(d.a)({},t),{},{lastUpdated:r,fetchState:i,ttl:c,fetchStates:o});switch(e.type){case A:return Object(d.a)(Object(d.a)({},s),{},{urls:{stationInfo:p(e.payload,"station_information"),stationStatus:p(e.payload,"station_status")}});case"STATION_INFORMATION_FETCHED":return Object(d.a)(Object(d.a)({},s),{},{stationInfo:e.payload.data.stations.sort((function(t,e){return t.name<e.name?-1:1}))});case"STATION_STATUS_FETCHED":return Object(d.a)(Object(d.a)({},s),{},{stationStatus:e.payload.data.stations});default:return t}}),Object(D.composeWithDevTools)(g.applyMiddleware.apply(void 0,H))),M=function(){return c.a.createElement(c.a.StrictMode,null,c.a.createElement(s.a,{store:w},c.a.createElement(k,null)))};i.a.render(c.a.createElement(M,null),document.getElementById("root"))}},[[16,1,2]]]);
//# sourceMappingURL=main.2643c761.chunk.js.map